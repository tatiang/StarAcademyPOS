<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Academy POS v1.93</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --space-indigo: #1a1a2e;
            --deep-purple: #16213e;
            --nebula-blue: #0f3460;
            --starlight: #e94560;
            --golden-bronze: #cd7f32;
            --cosmic-white: #f0f0f0;
            --success: #28a745;
            --danger: #dc3545;
            --stormy-teal: #17a2b8;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Roboto', sans-serif; background-color: var(--cosmic-white); color: #333; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        
        /* Typography & Headers */
        h1, h2, h3 { font-family: 'Orbitron', sans-serif; margin: 0; }

        /* Login Overlay */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--space-indigo); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; }
        #student-login-grid { display: flex; flex-wrap: wrap; justify-content: center; max-width: 800px; margin-top: 20px; gap: 20px; }
        
        /* Header */
        header { background: var(--space-indigo); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .logo { font-size: 1.5rem; font-weight: bold; color: var(--starlight); }
        #cloud-status-indicator { font-size: 0.8rem; background: rgba(255,255,255,0.1); padding: 4px 8px; border-radius: 4px; margin-left: 10px; }

        /* Navigation */
        nav { background: var(--deep-purple); color: white; padding: 10px; display: flex; justify-content: center; }
        .nav-links { list-style: none; padding: 0; margin: 0; display: flex; gap: 20px; }
        .nav-links li { padding: 10px 20px; cursor: pointer; border-radius: 5px; transition: background 0.3s; font-family: 'Orbitron', sans-serif; font-size: 0.9rem; }
        .nav-links li:hover, .nav-links li.active { background: var(--starlight); }
        
        /* Main Layout */
        main { flex: 1; display: flex; overflow: hidden; position: relative; }
        .view { display: none; width: 100%; height: 100%; padding: 20px; overflow-y: auto; background: #f4f4f9; }
        .view.active { display: block; }

        /* POS View */
        .pos-container { display: flex; height: 100%; gap: 20px; }
        .pos-grid-area { flex: 2; display: flex; flex-direction: column; }
        .pos-cart-area { flex: 1; background: white; border-radius: 10px; padding: 15px; display: flex; flex-direction: column; shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        #pos-categories { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 10px; }
        #pos-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; overflow-y: auto; padding: 5px; }

        .product-card { background: white; border-radius: 8px; padding: 10px; text-align: center; cursor: pointer; transition: transform 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; justify-content: space-between; height: 180px; }
        .product-card:hover { transform: translateY(-3px); border: 2px solid var(--golden-bronze); }
        .prod-img { width: 100%; height: 90px; object-fit: cover; border-radius: 5px; margin-bottom: 8px; }
        .prod-info h4 { font-size: 0.9rem; margin: 0 0 5px 0; color: var(--nebula-blue); }

        /* Cart */
        #cart-list { flex: 1; overflow-y: auto; margin-bottom: 15px; border-top: 1px solid #eee; border-bottom: 1px solid #eee; padding: 10px 0; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.9rem; }
        .cart-qty-controls { display: flex; align-items: center; gap: 5px; background: #eee; border-radius: 4px; padding: 2px; }
        .cart-qty-btn { border: none; background: white; width: 24px; height: 24px; cursor: pointer; border-radius: 3px; font-weight: bold; }
        .totals-area { font-size: 1.1rem; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .total-final { font-weight: bold; color: var(--starlight); font-size: 1.4rem; border-top: 2px solid #333; padding-top: 10px; margin-top: 5px; }

        /* Buttons */
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-family: 'Orbitron'; font-weight: bold; transition: 0.3s; }
        .btn-primary { background: var(--nebula-blue); color: white; width: 100%; margin-top: 10px; padding: 15px; font-size: 1.1rem; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; border-radius: 3px; cursor: pointer; border: 1px solid #ccc; background: white; }

        /* Manager & Tables */
        table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: var(--space-indigo); color: white; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center; }
        .modal.open { display: flex; }
        .modal-content { background: white; padding: 25px; border-radius: 10px; width: 90%; max-width: 500px; position: relative; max-height: 90vh; overflow-y: auto; }
        .close-modal { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer; }
        
        /* Inputs */
        .form-control { width: 100%; padding: 10px; margin: 5px 0 15px; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; }
        .opt-chip { display: inline-block; padding: 8px 12px; border: 1px solid var(--nebula-blue); color: var(--nebula-blue); border-radius: 20px; margin: 3px; cursor: pointer; font-size: 0.9rem; }
        .opt-chip.selected { background: var(--nebula-blue); color: white; }

        /* Calculator Grid */
        .calc-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .calc-btn { background: #eee; border: none; padding: 15px; font-size: 1.2rem; border-radius: 5px; cursor: pointer; }
        .calc-btn:active { background: #ccc; }
        .swipe-track { height: 60px; background: #ddd; border-radius: 5px; position: relative; overflow: hidden; margin: 20px 0; display:flex; align-items:center; justify-content:center; color:#888;}
        .swipe-track.swiped { background: #d4edda; color: #155724; border: 2px solid #28a745; }

        /* Utility */
        .hidden { display: none !important; }

        /* KIOSK MODE */
        #view-kiosk { background: var(--space-indigo); color: white; }
        #kiosk-grid .product-card { background: rgba(255,255,255,0.1); color: white; border: none; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <h1 style="color:var(--starlight); font-size: 3rem; margin-bottom: 10px;">STAR ACADEMY</h1>
        <p>Point of Sale System <span id="version-display">Loading...</span></p>
        <div id="student-login-grid">
            <p>Loading Cloud Data...</p>
        </div>
        <div style="margin-top: 40px;">
            <button class="btn" style="background:transparent; border:1px solid rgba(255,255,255,0.3); color:rgba(255,255,255,0.5);" onclick="window.app.promptPin('Manager')">Manager Access</button>
            <button class="btn" style="background:transparent; border:1px solid rgba(255,255,255,0.3); color:rgba(255,255,255,0.5);" onclick="window.app.promptPin('IT Support')">IT Access</button>
        </div>
    </div>

    <header>
        <div class="logo">
            <i class="fa-solid fa-star"></i> STAR ACADEMY 
            <span id="cloud-status-indicator">Offline</span>
        </div>
        <div>
            <span id="live-clock" style="margin-right: 15px; font-family:monospace; font-size:1.2rem;">00:00</span>
            <span id="header-cashier">Welcome</span>
            <button class="btn-sm" style="margin-left:10px; color:var(--danger);" onclick="window.app.logout()">Lock</button>
        </div>
    </header>

    <nav>
        <ul class="nav-links">
            <li id="nav-pos" onclick="window.app.navigate('pos')" class="active">Register</li>
            <li id="nav-timeclock" onclick="window.app.navigate('timeclock')">Time Clock</li>
            <li id="nav-inventory" onclick="window.app.navigate('inventory')">Inventory</li>
            <li id="nav-barista" onclick="window.app.navigate('barista')">Barista View</li>
            <li id="nav-manager" onclick="window.app.navigate('manager')" class="nav-admin-link" style="display:none;">Manager</li>
            <li id="nav-it" onclick="window.app.navigate('it')" class="nav-admin-link" style="display:none;">IT Config</li>
        </ul>
    </nav>

    <main>
        
        <div id="view-pos" class="view active">
            <div class="pos-container">
                <div class="pos-grid-area">
                    <div id="pos-categories"></div>
                    <div id="pos-grid"></div>
                </div>
                <div class="pos-cart-area">
                    <div class="form-group">
                        <input type="text" id="customer-name" class="form-control" placeholder="Student Name / ID">
                    </div>
                    <div id="cart-list"></div>
                    <div class="totals-area">
                        <div class="total-row"><span>Subtotal</span><span id="pos-subtotal">$0.00</span></div>
                        <div class="total-row"><span>Tax (9.25%)</span><span id="pos-tax">$0.00</span></div>
                        <div class="total-final"><span id="pos-total">$0.00</span></div>
                        <button class="btn btn-primary" style="background:var(--success);" onclick="window.app.validateAndPay('Cash')">CASH</button>
                        <button class="btn btn-primary" onclick="window.app.validateAndPay('Card')">CARD</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-timeclock" class="view">
            <div class="card" style="max-width: 1000px; margin: 0 auto;">
                <h2 class="card-title" style="border-bottom: 2px solid #eee; padding-bottom:10px; margin-bottom:20px;">Employee Time Clock</h2>
                
                <div id="time-clock-grid" class="tc-grid">
                    <p style="text-align:center; color:#888;">Initializing Time Clock...</p>
                </div>

                <div style="margin-top: 30px; text-align: right;">
                    <button class="btn" style="background:#666; color:white;" onclick="window.app.printTimesheet()">Print Report</button>
                </div>
            </div>
        </div>

        <div id="view-inventory" class="view">
            <div class="card">
                <h2>Inventory Status</h2>
                <table>
                    <thead><tr><th>Product</th><th>Status</th></tr></thead>
                    <tbody id="inventory-body"></tbody>
                </table>
            </div>
        </div>

        <div id="view-barista" class="view">
            <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap:15px;" id="barista-grid"></div>
        </div>

        <div id="view-manager" class="view">
            <div style="display:flex; gap:10px; margin-bottom:20px;">
                <button class="btn mgr-tab active" onclick="window.app.switchMgrTab('staff')">Staff</button>
                <button class="btn mgr-tab" onclick="window.app.switchMgrTab('menu')">Menu</button>
                <button class="btn mgr-tab" onclick="window.app.switchMgrTab('data')">Data</button>
            </div>

            <div id="mgr-sub-staff" class="mgr-subview active">
                <div class="card">
                    <div style="display:flex; justify-content:space-between;"><h3>Employees</h3><button class="btn-sm" onclick="window.app.editEmployee()">+ Add</button></div>
                    <table style="margin-top:10px;"><tbody id="mgr-employee-list"></tbody></table>
                </div>
                <div class="card">
                    <div style="display:flex; justify-content:space-between;"><h3>Roles</h3><button class="btn-sm" onclick="window.app.editRole()">+ Add</button></div>
                    <table style="margin-top:10px;"><tbody id="mgr-role-list"></tbody></table>
                </div>
            </div>

            <div id="mgr-sub-menu" class="mgr-subview" style="display:none;">
                <div class="card">
                    <div style="display:flex; justify-content:space-between;"><h3>Products</h3><button class="btn-sm" onclick="window.app.editProduct()">+ Add</button></div>
                    <table style="margin-top:10px;"><tbody id="mgr-product-list"></tbody></table>
                </div>
                <div class="card">
                    <div style="display:flex; justify-content:space-between;"><h3>Categories</h3><button class="btn-sm" onclick="window.app.editCategory()">+ Add</button></div>
                    <ul id="mgr-cat-list" style="list-style:none; padding:0;"></ul>
                </div>
            </div>

             <div id="mgr-sub-data" class="mgr-subview" style="display:none;">
                <div class="card">
                    <h3>Sales Overview</h3>
                    <div style="display:flex; gap:20px; margin-top:10px;">
                        <div style="background:var(--nebula-blue); color:white; padding:20px; border-radius:10px; flex:1;">
                            <h3>Revenue</h3><div id="dash-revenue" style="font-size:2rem;">$0.00</div>
                        </div>
                        <div style="background:var(--golden-bronze); color:white; padding:20px; border-radius:10px; flex:1;">
                            <h3>Orders</h3><div id="dash-orders" style="font-size:2rem;">0</div>
                        </div>
                    </div>
                    <button class="btn" style="margin-top:20px;" onclick="window.app.viewReceipts()">View Receipts</button>
                    <button class="btn" style="margin-top:20px;" onclick="window.app.startKioskMode()">Enter Kiosk Mode</button>
                </div>
            </div>
        </div>

        <div id="view-it" class="view">
            <div class="card">
                <h2>IT Configuration</h2>
                <p>Version: <span id="it-version-display"></span></p>
                <button class="btn" onclick="localStorage.clear(); location.reload();" style="background:var(--danger);">Hard Reset (Clear Data)</button>
            </div>
        </div>

        <div id="view-kiosk" class="view">
            <div style="text-align:center; padding:20px;">
                <h1>STAR ACADEMY KIOSK</h1>
                <p>Browse our menu</p>
            </div>
            <div id="kiosk-grid" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:20px; padding:20px;"></div>
            <button class="btn" style="position:fixed; bottom:20px; right:20px; opacity:0.3;" onclick="window.app.exitKioskMode()">Exit</button>
        </div>

    </main>

    <div id="modal-options" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="window.app.closeModal('modal-options')">&times;</span>
            <h2 id="opt-product-name">Product</h2>
            <p>Customize your order:</p>
            <div id="opt-checkboxes" style="margin-bottom:15px;"></div>
            <textarea id="opt-notes" class="form-control" placeholder="Special Instructions..."></textarea>
            <button class="btn btn-primary" onclick="window.app.confirmAddToCart()">Add to Order</button>
        </div>
    </div>

    <div id="modal-cash" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="window.app.closeModal('modal-cash')">&times;</span>
            <h2>Cash Payment</h2>
