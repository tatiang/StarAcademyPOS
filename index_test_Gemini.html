<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Academy POS v1.93</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --space-indigo: #1a1a2e;
            --star-gold: #ffd700;
            --nebula-purple: #6a0dad;
            --stardust-gray: #f4f4f9;
            --deep-blue: #16213e;
            --accent-pink: #e94560;
            --success: #28a745;
            --danger: #dc3545;
            --golden-bronze: #cd7f32; 
            --stormy-teal: #0f4c75;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--stardust-gray); color: var(--space-indigo); overflow-x: hidden; }

        /* HEADER */
        header { background: linear-gradient(90deg, var(--space-indigo), var(--deep-blue)); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .logo { font-size: 1.8rem; font-weight: bold; color: var(--star-gold); display: flex; align-items: center; gap: 10px; }
        .header-info { display: flex; align-items: center; gap: 20px; }
        .clock { font-size: 1.2rem; font-family: monospace; background: rgba(0,0,0,0.3); padding: 5px 10px; border-radius: 5px; }
        .status-badge { font-size: 0.8rem; background: rgba(255,255,255,0.1); padding: 4px 8px; border-radius: 12px; }

        /* LAYOUT */
        .main-container { display: flex; height: calc(100vh - 70px); }
        
        /* SIDEBAR */
        .sidebar { width: 260px; background: white; border-right: 1px solid #ddd; display: flex; flex-direction: column; }
        .nav-links { list-style: none; padding: 0; margin: 0; flex: 1; }
        .nav-links li { padding: 15px 20px; cursor: pointer; border-bottom: 1px solid #eee; transition: background 0.2s; display: flex; align-items: center; gap: 10px; font-size: 1.1rem; }
        .nav-links li:hover { background: #f0f0f0; padding-left: 25px; }
        .nav-links li.active { background: var(--stormy-teal); color: white; border-left: 5px solid var(--star-gold); }
        .nav-links li i { width: 25px; text-align: center; }

        /* CONTENT AREA */
        .content { flex: 1; padding: 20px; overflow-y: auto; position: relative; }
        .view { display: none; animation: fadeIn 0.3s ease; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* POS GRID */
        .cat-nav { margin-bottom: 15px; overflow-x: auto; white-space: nowrap; padding-bottom: 5px; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
        .product-card { background: white; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); overflow: hidden; cursor: pointer; transition: transform 0.2s; border: 1px solid #eee; }
        .product-card:hover { transform: translateY(-3px); border-color: var(--star-gold); }
        .prod-img { width: 100%; height: 100px; object-fit: cover; background: #ddd; }
        .prod-info { padding: 10px; text-align: center; }
        .prod-info h4 { margin: 0 0 5px 0; font-size: 0.95rem; }

        /* CART SIDEBAR (Right) */
        .cart-panel { width: 320px; background: white; border-left: 1px solid #ddd; display: flex; flex-direction: column; padding: 15px; }
        .cart-header { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--star-gold); }
        .cart-items { flex: 1; overflow-y: auto; margin-bottom: 15px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; font-size: 0.9rem; }
        .cart-qty-controls { display: flex; align-items: center; gap: 5px; }
        .cart-qty-btn { width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ccc; background: #fff; cursor: pointer; }
        .totals-area { background: #f9f9f9; padding: 15px; border-radius: 8px; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .grand-total { font-size: 1.3rem; font-weight: bold; color: var(--space-indigo); border-top: 1px solid #ccc; padding-top: 5px; margin-top: 5px; }

        /* BUTTONS */
        .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: bold; transition: opacity 0.2s; margin-top: 5px; }
        .btn-primary { background: var(--space-indigo); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-sm { padding: 5px 10px; width: auto; font-size: 0.8rem; border-radius: 4px; border: none; cursor: pointer; background: #ddd; }

        /* MODALS */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal.open { display: flex; }
        .modal-content { background: white; padding: 25px; border-radius: 12px; width: 90%; max-width: 500px; position: relative; max-height: 90vh; overflow-y: auto; }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 1.5rem; cursor: pointer; color: #888; }
        
        /* LOGIN OVERLAY */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--space-indigo); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; }
        .login-box { text-align: center; max-width: 600px; width: 90%; }
        
        /* MANAGER TABS */
        .mgr-tabs { display: flex; border-bottom: 2px solid #ddd; margin-bottom: 20px; }
        .mgr-tab { padding: 10px 20px; cursor: pointer; border-bottom: 3px solid transparent; }
        .mgr-tab.active { border-bottom-color: var(--star-gold); font-weight: bold; color: var(--space-indigo); }
        .mgr-subview { display: none; }
        .mgr-subview.active { display: block; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { text-align: left; padding: 10px; border-bottom: 1px solid #eee; }

        /* FORM CONTROLS */
        .form-group { margin-bottom: 15px; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-top: 5px; }
        .opt-chip { display: inline-block; padding: 5px 12px; background: #eee; border-radius: 15px; margin: 3px; cursor: pointer; user-select: none; }
        .opt-chip.selected { background: var(--star-gold); color: black; font-weight: bold; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box">
            <h1><i class="fa-solid fa-star"></i> STAR ACADEMY POS</h1>
            <p>Select User to Login</p>
            <div id="student-login-grid" style="background: white; padding: 20px; border-radius: 10px; color: black; min-height:100px;">
                Loading Users...
            </div>
            <br>
            <p><small>v1.93</small></p>
        </div>
    </div>

    <header>
        <div class="logo"><i class="fa-solid fa-rocket"></i> STAR POS</div>
        <div class="header-info">
            <span id="cloud-status-indicator" class="status-badge" style="background:rgba(255,255,0,0.2); color:#ffecb3;">Connecting...</span>
            <div id="header-cashier">Guest</div>
            <div id="live-clock" class="clock">00:00</div>
            <button class="btn-sm" onclick="window.app.logout()" style="background:rgba(255,255,255,0.2); color:white;">Logout</button>
        </div>
    </header>

    <div class="main-container">
        <nav class="sidebar">
            <ul class="nav-links">
                <li id="nav-pos" onclick="window.app.navigate('pos')"><i class="fa-solid fa-cash-register"></i> Register</li>
                <li id="nav-timeclock" onclick="window.app.navigate('timeclock')"><i class="fa-solid fa-clock"></i> Time Clock</li>
                <li id="nav-barista" onclick="window.app.navigate('barista')"><i class="fa-solid fa-mug-hot"></i> Barista View</li>
                <li id="nav-inventory" class="nav-admin-link" onclick="window.app.promptPin('IT Support')"><i class="fa-solid fa-boxes-stacked"></i> Inventory</li>
                <li id="nav-manager" class="nav-admin-link" onclick="window.app.promptPin('Manager')"><i class="fa-solid fa-user-tie"></i> Manager</li>
                <li id="nav-kiosk" onclick="window.app.startKioskMode()"><i class="fa-solid fa-tablet-screen-button"></i> Kiosk Mode</li>
            </ul>
        </nav>

        <div class="content">
            
            <div id="view-pos" class="view">
                <div class="cat-nav" id="pos-categories"></div>
                <div class="grid-container" id="pos-grid"></div>
            </div>

            <div id="view-timeclock" class="view">
                <div class="card" style="background:white; padding:20px; border-radius:10px; max-width:800px; margin:0 auto;">
                    <h2 class="card-title">Employee Time Clock</h2>
                    <div id="time-clock-grid" class="tc-grid">
                        <p style="text-align:center;">Loading Employees...</p>
                    </div>
                    <div style="margin-top:20px; text-align:center;">
                        <button class="btn-sm" onclick="window.app.printTimesheet()">Print Report</button>
                    </div>
                </div>
            </div>

            <div id="view-barista" class="view">
                <h2>Pending Orders</h2>
                <div id="barista-grid"></div>
            </div>

            <div id="view-inventory" class="view">
                <h2>Stock Levels</h2>
                <table style="background:white;">
                    <thead><tr><th>Product</th><th>Status</th></tr></thead>
                    <tbody id="inventory-body"></tbody>
                </table>
            </div>

            <div id="view-kiosk" class="view">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h1>Self Order Kiosk</h1>
                    <button class="btn-sm" style="background:white;" onclick="window.app.exitKioskMode()">Exit</button>
                </div>
                <div class="grid-container" id="kiosk-grid"></div>
            </div>

            <div id="view-manager" class="view">
                <div class="mgr-tabs">
                    <div class="mgr-tab active" onclick="window.app.switchMgrTab('staff')">Staff</div>
                    <div class="mgr-tab" onclick="window.app.switchMgrTab('menu')">Menu</div>
                    <div class="mgr-tab" onclick="window.app.switchMgrTab('data')">Data</div>
                </div>

                <div id="mgr-sub-staff" class="mgr-subview active">
                    <button class="btn-sm btn-primary" onclick="window.app.editEmployee()">+ Add Employee</button>
                    <button class="btn-sm" onclick="window.app.editRole()">+ Add Role</button>
                    <div style="display:flex; gap:20px; margin-top:15px;">
                        <div style="flex:1;">
                            <h3>Employees</h3>
                            <table style="background:white;"><tbody id="mgr-employee-list"></tbody></table>
                        </div>
                        <div style="flex:1;">
                            <h3>Roles</h3>
                            <table style="background:white;"><tbody id="mgr-role-list"></tbody></table>
                        </div>
                    </div>
                </div>

                <div id="mgr-sub-menu" class="mgr-subview">
                    <button class="btn-sm btn-primary" onclick="window.app.editProduct()">+ Add Product</button>
                    <button class="btn-sm" onclick="window.app.editCategory()">+ Add Category</button>
                    <div style="margin-top:15px; background:white; padding:10px;">
                        <h3>Categories</h3>
                        <ul id="mgr-cat-list" style="list-style:none; padding:0;"></ul>
                        <h3>Products</h3>
                        <table style="background:white;"><tbody id="mgr-product-list"></tbody></table>
                    </div>
                </div>

                <div id="mgr-sub-data" class="mgr-subview">
                    <h3>Sales & Reports</h3>
                    <div style="display:flex; gap:20px;">
                        <div style="background:white; padding:20px; border-radius:8px; flex:1;">
                            <h4>Total Revenue</h4>
                            <div id="dash-revenue" style="font-size:2rem; font-weight:bold;">$0.00</div>
                        </div>
                        <div style="background:white; padding:20px; border-radius:8px; flex:1;">
                            <h4>Orders Count</h4>
                            <div id="dash-orders" style="font-size:2rem; font-weight:bold;">0</div>
                        </div>
                    </div>
                    <br>
                    <button class="btn" onclick="window.app.viewReceipts()">View Receipt History</button>
                </div>
            </div>

            <div id="view-it" class="view">
                <h2>IT Support Console</h2>
                <p>System Maintenance Only</p>
                <button class="btn btn-danger" onclick="localStorage.clear(); location.reload();">Hard Reset System</button>
            </div>

        </div> <div class="cart-panel">
            <div class="cart-header"><i class="fa-solid fa-basket-shopping"></i> Current Order</div>
            
            <div class="form-group">
                <input type="text" id="customer-name" class="form-control" placeholder="Customer Name">
            </div>

            <div class="cart-items" id="cart-list"></div>

            <div class="totals-area">
                <div class="total-row"><span>Subtotal:</span><span id="pos-subtotal">$0.00</span></div>
                <div class="total-row"><span>Tax (9.25%):</span><span id="pos-tax">$0.00</span></div>
                <div class="total-row grand-total"><span>Total:</span><span id="pos-total">$0.00</span></div>
                
                <div style="display:flex; gap:10px; margin-top:15px;">
                    <button class="btn btn-success" onclick="window.app.validateAndPay('Cash')"><i class="fa-solid fa-money-bill"></i> Cash</button>
                    <button class="btn btn-primary" onclick="window.app.validateAndPay('Card')"><i class="fa-solid fa-credit-card"></i> Card</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-options" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('modal-options').classList.remove('open')">&times;</span>
            <h2 id="opt-product-name">Options</h2>
            <div id="opt-checkboxes" style="margin-bottom:15px;"></div>
            <textarea id="opt-notes" class="form-control" placeholder="Special Instructions..."></textarea>
            <button class="btn btn-success" style="margin-top:15px;" onclick="window.app.confirmAddToCart()">Add to Order</button>
        </div>
    </div>

    <div id="modal-cash" class="modal">
        <div class="modal-content" style="text-align:center;">
            <span class="close-modal" onclick="document.getElementById('modal-cash').classList.remove('open')">&times;</span>
            <h2>Cash Payment</h2>
            <h3 id="cash-total-due">Total: $0.00</h3>
            <div id="calc-display" style="font-size:2rem; background:#eee; padding:10px; margin:10px 0; font-family:monospace;">$0.00</div>
            
            <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; max-width:250px; margin:0 auto;">
                <button class="btn-sm" onclick="window.app.cashInput('1')">1</button>
                <button class="btn-sm" onclick="window.app.cashInput('2')">2</button>
                <button class="btn-sm" onclick="window.app.cashInput('3')">3</button>
                <button class="btn-sm" onclick="window.app.cashInput('4')">4</button>
                <button class="btn-sm" onclick="window.app.cashInput('5')">5</button>
                <button class="btn-sm" onclick="window.app.cashInput('6')">6</button>
                <button class="btn-sm" onclick="window.app.cashInput('7')">7</button>
                <button class="btn-sm" onclick="window.app.cashInput('8')">8</button>
                <button class="btn-sm" onclick="window.app.cashInput('9')">9</button>
                <button class="btn-sm" onclick="window.app.cashInput('.')">.</button>
                <button class="btn-sm" onclick="window.app.cashInput('0')">0</button>
                <button class="btn-sm" style="background:#f8d7da;" onclick="window.app.cashClear()">C</button>
            </div>
            <div style="margin-top:10px; display:flex; gap:5px; justify-content:center;">
                <button class="btn-sm" onclick="window.app.addCash(1)">+$1</button>
                <button class="btn-sm" onclick="window.app.addCash(5)">+$5</button>
                <button class="btn-sm" onclick="window.app.addCash(10)">+$10</button>
                <button class="btn-sm" onclick="window.app.addCash(20)">+$20</button>
            </div>

            <div id="change-display-box" style="margin-top:15px; padding:10px; border-radius:5px; font-weight:bold;">Change Due: $0.00</div>
            <button class="btn btn-success" style="margin-top:15px;" onclick="window.app.finalizeCash()">Complete Sale</button>
        </div>
    </div>

    <div id="modal-card" class="modal">
        <div class="modal-content" style="text-align:center;">
            <span class="close-modal" onclick="document.getElementById('modal-card').classList.remove('open')">&times;</span>
            <h2>Card Processing</h2>
            
            <div class="swipe-area" style="background:#f0f0f0; padding:20px; border-radius:8px; margin-bottom:15px; position:relative; overflow:hidden;">
                <div class="swipe-track" style="height:40px; background:#ddd; border-radius:20px; position:relative;">
                    <div style="position:absolute; top:5px; left:10px; color:#888;">Swipe Card Here -></div>
                </div>
                <button class="btn-sm" style="margin-top:10px;" onclick="window.app.simulateSwipe()">[Simulate Swipe]</button>
            </div>
            
            <p>Or Enter Manually:</p>
            <input id="cc-num" class="form-control" placeholder="Card Number" style="margin-bottom:5px;">
            <div style="display:flex; gap:10px;">
                <input id="cc-exp" class="form-control" placeholder="MM/YY">
                <input id="cc-cvv" class="form-control" placeholder="CVV">
            </div>
            
            <div id="card-msg" style="color:var(--success); font-weight:bold; height:20px; margin:10px 0;"></div>
            <button id="btn-process-card" class="btn btn-primary" onclick="window.app.finalizeCard()">Charge Card</button>
        </div>
    </div>

    <div id="modal-pin" class="modal">
        <div class="modal-content" style="text-align:center; max-width:300px;">
            <span class="close-modal" onclick="document.getElementById('modal-pin').classList.remove('open')">&times;</span>
            <h3>Security Check</h3>
            <div id="pin-display" style="font-size:2rem; letter-spacing:5px; margin-bottom:15px;">Enter PIN</div>
            <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;">
                <button class="btn-sm" onclick="window.app.pinInput('1')">1</button>
                <button class="btn-sm" onclick="window.app.pinInput('2')">2</button>
                <button class="btn-sm" onclick="window.app.pinInput('3')">3</button>
                <button class="btn-sm" onclick="window.app.pinInput('4')">4</button>
                <button class="btn-sm" onclick="window.app.pinInput('5')">5</button>
                <button class="btn-sm" onclick="window.app.pinInput('6')">6</button>
                <button class="btn-sm" onclick="window.app.pinInput('7')">7</button>
                <button class="btn-sm" onclick="window.app.pinInput('8')">8</button>
                <button class="btn-sm" onclick="window.app.pinInput('9')">9</button>
                <button class="btn-sm" style="background:#f8d7da;" onclick="window.app.pinClear()">C</button>
                <button class="btn-sm" onclick="window.app.pinInput('0')">0</button>
                <button class="btn-sm" style="background:#d4edda;" onclick="window.app.pinSubmit()">OK</button>
            </div>
        </div>
    </div>

    <div id="modal-generic" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('modal-generic').classList.remove('open')">&times;</span>
            <h2 id="gen-modal-title">Edit</h2>
            <div id="gen-modal-body"></div>
            <div style="margin-top:15px; text-align:right;">
                <button id="gen-save-btn" class="btn btn-success" style="width:auto;">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="modal-product" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('modal-product').classList.remove('open')">&times;</span>
            <h2>Edit Product</h2>
            <input type="hidden" id="edit-prod-id">
            
            <div class="form-group">
                <label>Name</label>
                <input id="edit-prod-name" class="form-control">
            </div>
            
            <div style="display:flex; gap:10px;">
                <div class="form-group" style="flex:1;">
                    <label>Price</label>
                    <input id="edit-prod-price" type="number" step="0.01" class="form-control">
                </div>
                <div class="form-group" style="flex:1;">
                    <label>Category</label>
                    <select id="edit-prod-cat" class="form-control"></select>
                </div>
            </div>

            <div class="form-group">
                <label>Options (comma separated)</label>
                <input id="edit-prod-opts" class="form-control" placeholder="Milk, Sugar, Ice...">
            </div>

            <div class="form-group">
                <label>Image URL</label>
                <div style="display:flex; gap:5px;">
                    <input id="edit-prod-img" class="form-control" onchange="window.app.updateImagePreview()">
                    <button class="btn-sm" onclick="window.app.generateAIImage()" style="white-space:nowrap;">Magic AI</button>
                </div>
            </div>
            
            <div id="img-preview-box" style="width:100%; height:150px; background:#f0f0f0; display:flex; align-items:center; justify-content:center; border-radius:5px; overflow:hidden;">
                <span>Preview</span>
            </div>

            <button class="btn btn-success" style="margin-top:15px;" onclick="window.app.saveProduct()">Save Product</button>
        </div>
    </div>

    <div id="modal-receipts" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('modal-receipts').classList.remove('open')">&times;</span>
            <h2>Past Receipts</h2>
            <div id="receipt-list" style="max-height:300px; overflow-y:auto;"></div>
        </div>
    </div>

    <div id="print-area" style="display:none;"></div>

    <script src="js/version_test_Gemini.js"></script>
    <script src="js/firestore_test_Gemini.js"></script>
    <script src="js/app_test_Gemini.js"></script>

</body>
</html>
