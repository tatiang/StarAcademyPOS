<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Star Academy POS v1.15</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- THEME & COLORS --- */
        :root {
            --space-indigo: #1E2741;
            --stormy-teal: #307785;
            --white-smoke: #F5F5F6;
            --golden-bronze: #CB9832;
            --white: #FFFFFF;
            --bg-app: var(--white-smoke);
            --text-dark: #333333;
            --danger: #c0392b;
            --success: #27ae60; 
            --barista-purple: #8e44ad;
            --clock-orange: #f39c12;
            --sidebar-width: 260px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Open Sans', sans-serif; background-color: var(--bg-app); color: var(--text-dark); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* PRINT STYLES */
        @media print {
            body > * { display: none !important; }
            #modal-receipt { display: flex !important; }
            #modal-receipt .modal-content { box-shadow: none; border: none; padding: 0; width: 100%; max-width: 100%; }
            #receipt-content { display: block !important; border: none; padding: 20px; font-family: 'Courier New', Courier, monospace; }
            .no-print { display: none !important; }
        }

        /* LOGIN & LAYOUT */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--space-indigo); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--white); }
        .login-box { background: var(--white); padding: 40px; border-radius: 12px; text-align: center; width: 90%; max-width: 700px; color: var(--text-dark); box-shadow: 0 10px 30px rgba(0,0,0,0.3); border-top: 6px solid var(--golden-bronze); position: relative; }
        .login-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 20px; margin-top: 30px; margin-bottom: 30px; }
        .login-btn-wrap { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .login-btn-wrap:hover { transform: scale(1.05); }
        .login-btn-img { width: 90px; height: 90px; border-radius: 50%; object-fit: cover; border: 4px solid var(--golden-bronze); margin-bottom: 10px; background: #eee; }
        .login-btn-name { font-weight: 700; color: var(--space-indigo); font-size: 1.1rem; }
        
        .app-wrapper { display: flex; flex: 1; height: 100%; overflow: hidden; }
        .sidebar { width: var(--sidebar-width); background-color: var(--space-indigo); color: var(--white); display: flex; flex-direction: column; padding: 20px; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
        .logo-area { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo-img { max-width: 100%; height: auto; max-height: 80px; }
        
        .nav-links { list-style: none; flex-grow: 1; }
        .nav-links li { padding: 15px; margin-bottom: 8px; border-radius: 6px; cursor: pointer; font-size: 1.1rem; font-weight: 600; transition: all 0.2s; border-left: 4px solid transparent; }
        .nav-links li:hover { background-color: rgba(255,255,255,0.05); }
        .nav-links li.active { background-color: rgba(255,255,255,0.1); border-left-color: var(--golden-bronze); color: var(--golden-bronze); }
        .nav-links li i { margin-right: 12px; width: 25px; text-align: center; }
        .sidebar-footer { margin-top: auto; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;}
        .sidebar-version { font-size: 0.8rem; opacity: 0.5; margin-bottom: 5px; color: var(--white); display: block;}

        .top-bar { background-color: var(--stormy-teal); color: var(--white); padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 10; }
        .current-cashier-display { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; }
        .cashier-avatar { width: 35px; height: 35px; border-radius: 50%; margin-right: 10px; border: 2px solid var(--golden-bronze); object-fit: cover; }
        
        #cloud-status { display: flex; align-items: center; gap: 8px; font-size: 0.9rem; background: rgba(0,0,0,0.2); padding: 5px 12px; border-radius: 20px; cursor: default; pointer-events: none; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; background-color: #ccc; }
        .status-dot.online { background-color: #2ecc71; box-shadow: 0 0 5px #2ecc71; }
        .status-dot.syncing { background-color: #f1c40f; animation: pulse 1s infinite; }
        .status-dot.error { background-color: #e74c3c; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .main-content { flex-grow: 1; background-color: var(--bg-app); overflow-y: hidden; position: relative; display: flex; flex-direction: column; }
        .view { display: none; height: 100%; padding: 20px; overflow-y: auto; }
        .view.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Components */
        .pos-layout { display: flex; gap: 20px; height: 100%; }
        .product-section { flex: 2; display: flex; flex-direction: column; overflow: hidden; }
        .category-tabs { display: flex; gap: 10px; padding-bottom: 10px; overflow-x: auto; flex-shrink: 0; }
        .cat-tab { background: var(--white); color: var(--space-indigo); padding: 12px 20px; border-radius: 25px; border: 2px solid #ddd; cursor: pointer; font-weight: 600; white-space: nowrap; }
        .cat-tab.active { background: var(--space-indigo); color: var(--white); border-color: var(--space-indigo); }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; overflow-y: auto; padding: 5px; padding-bottom: 80px; }
        .product-card { background: var(--white); border-radius: 10px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.08); cursor: pointer; transition: transform 0.1s; border: 1px solid #eee; display: flex; flex-direction: column;}
        .product-card:active { transform: scale(0.96); }
        .p-image { height: 100px; width: 100%; background-color: #eee; background-size: cover; background-position: center; }
        .p-info { padding: 10px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between;}
        .p-name { font-weight: 700; font-size: 0.95rem; color: var(--space-indigo); margin-bottom: 4px; }
        .p-price { color: var(--golden-bronze); font-weight: bold; }

        .cart-panel { flex: 1; min-width: 340px; background: var(--white); border-radius: 10px; display: flex; flex-direction: column; box-shadow: -2px 0 15px rgba(0,0,0,0.05); border-top: 5px solid var(--golden-bronze); }
        .cart-header { padding: 15px; border-bottom: 1px solid #eee; background: #fcfcfc; border-radius: 10px 10px 0 0;}
        .cart-items { flex-grow: 1; overflow-y: auto; padding: 0 15px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
        .item-info h4 { font-size: 0.95rem; color: var(--space-indigo); }
        .item-info .opts { font-size: 0.75rem; color: #777; font-style: italic; }
        .qty-control { display: flex; align-items: center; gap: 8px; }
        .btn-qty { width: 28px; height: 28px; border-radius: 50%; border: 1px solid #ddd; background: #f9f9f9; cursor: pointer; color: var(--space-indigo); }
        .btn-del { color: var(--danger); background: none; border: none; cursor: pointer; margin-left: 5px;}
        .cart-totals { padding: 15px; background: #fafafa; border-top: 1px solid #eee; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 1rem; }
        .grand-total { font-size: 1.4rem; font-weight: 800; color: var(--space-indigo); margin-top: 10px; border-top: 1px solid #ddd; padding-top: 10px; }
        .cart-actions { padding: 15px; display: grid; gap: 10px; }
        .btn-pay { padding: 15px; border: none; border-radius: 6px; font-size: 1.1rem; font-weight: bold; color: var(--white); cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .btn-cash { background-color: var(--success); }
        .btn-card { background-color: var(--space-indigo); }
        .btn-train { background-color: #95a5a6; }
        .btn-gold { background-color: var(--golden-bronze); }

        #customer-name { font-size: 1.2rem; padding: 15px; border: 2px solid var(--golden-bronze); border-radius: 8px; background: #fffdf8; color: var(--space-indigo); font-weight: 600; width: 100%; box-sizing: border-box;}
        #customer-name::placeholder { color: #999; font-weight: 400; }

        .barista-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .order-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 1px solid #eee; }
        .oc-header { background: var(--barista-purple); color: white; padding: 15px; }
        .oc-title { display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; }
        .oc-customer { font-size: 0.9rem; margin-top: 5px; opacity: 0.9; }
        .oc-body { padding: 15px; min-height: 150px; }
        .oc-item { margin-bottom: 10px; border-bottom: 1px dashed #eee; padding-bottom: 5px; }
        .oc-item-name { font-weight: bold; font-size: 1.1rem; color: var(--space-indigo); }
        .oc-opts { display: inline-block; background: #fff3cd; color: #856404; font-size: 0.8rem; padding: 2px 6px; border-radius: 4px; margin-top: 4px; }
        .oc-footer { padding: 15px; border-top: 1px solid #eee; }
        .btn-ready { width: 100%; background: var(--success); color: white; border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; }

        .dash-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .stat-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--white); padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; align-items: center; gap: 15px; border-left: 5px solid var(--stormy-teal); }
        .stat-icon { font-size: 2rem; color: var(--stormy-teal); }
        .stat-data h3 { font-size: 0.9rem; color: #777; text-transform: uppercase; }
        .stat-data p { font-size: 1.5rem; font-weight: bold; color: var(--space-indigo); }
        
        .recent-orders { background: var(--white); border-radius: 10px; padding: 20px; }
        .ro-header { font-size: 1.2rem; margin-bottom: 15px; color: var(--space-indigo); border-bottom: 2px solid var(--golden-bronze); padding-bottom: 5px; display: inline-block;}
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 12px; background: #f8f9fa; color: #666; font-size: 0.9rem; }
        td { padding: 12px; border-bottom: 1px solid #eee; vertical-align: middle; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; border-radius: 4px; background: var(--stormy-teal); color: var(--white); border: none; cursor: pointer; }
        .btn-danger-sm { background: var(--danger); }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        .status-badge.stock-ok { background: #d4edda; color: #155724; }
        .status-badge.stock-low { background: #f8d7da; color: #721c24; }

        .clock-header { background: var(--clock-orange); color: white; padding: 40px; border-radius: 12px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3); }
        .clock-time { font-size: 4rem; font-weight: 700; margin-bottom: 10px; text-shadow: 1px 1px 3px rgba(0,0,0,0.2); }
        .clock-date { font-size: 1.2rem; opacity: 0.9; }
        .clock-controls { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: flex; gap: 20px; align-items: center; }
        .clock-select { flex: 1; padding: 12px; font-size: 1.1rem; border: 1px solid #ddd; border-radius: 6px; }
        .btn-clock { padding: 12px 30px; border: none; border-radius: 6px; font-size: 1.1rem; font-weight: bold; cursor: pointer; color: white; }
        .active-workers { margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap; }
        .worker-pill { background: #d4edda; color: #155724; padding: 8px 15px; border-radius: 20px; font-weight: bold; display: flex; align-items: center; gap: 8px; border: 1px solid #c3e6cb;}

        .manager-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
        .manager-box { background: white; padding: 20px; border-radius: 10px; height: 100%; border-top: 4px solid var(--golden-bronze); }
        .bug-form textarea { width: 100%; height: 80px; resize: vertical; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }

        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(30, 39, 65, 0.7); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal.open { display: flex; }
        .modal-content { background: var(--white); padding: 25px; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        
        .opt-group-title { margin-top: 15px; font-weight: bold; color: var(--stormy-teal); }
        .opt-buttons { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px; }
        .opt-btn { padding: 8px 15px; border: 1px solid #ddd; background: #f9f9f9; border-radius: 20px; cursor: pointer; transition: all 0.2s; }
        .opt-btn.selected { background: var(--golden-bronze); color: var(--white); border-color: var(--golden-bronze); }
        .custom-note-input { width: 100%; padding: 10px; margin-top: 10px; border: 1px solid #ddd; border-radius: 6px; }

        .calc-display { background: var(--white-smoke); padding: 15px; text-align: right; font-size: 2rem; font-weight: bold; border-radius: 8px; margin-bottom: 20px; color: var(--space-indigo); border: 1px solid #ddd; }
        .calc-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .calc-btn { padding: 15px; font-size: 1.2rem; background: var(--white); border: 1px solid #ddd; border-radius: 6px; cursor: pointer; color: var(--space-indigo); }
        .change-result { background: #dff0d8; color: #3c763d; padding: 15px; text-align: center; font-size: 1.5rem; font-weight: bold; border-radius: 8px; margin-bottom: 20px; display: none; }

        .receipt-paper { font-family: 'Courier New', Courier, monospace; border: 1px solid #ddd; padding: 20px; background: #fff; margin-bottom: 20px; font-size: 0.9rem; }
        .r-center { text-align: center; margin-bottom: 10px; }
        .r-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
        .r-line { border-bottom: 1px dashed #000; margin: 10px 0; }
        .r-total { font-weight: bold; font-size: 1.1rem; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: var(--space-indigo); }
        .form-control { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; }
        .emp-thumb { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--stormy-teal); }
        .hidden { display: none !important; }

        /* CUSTOM PIN PAD MODAL */
        #pin-pad-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 15px; }
        .pin-btn { padding: 20px; font-size: 1.5rem; border-radius: 10px; border: 1px solid #ddd; background: white; cursor: pointer; color: var(--space-indigo); font-weight: bold; }
        .pin-btn:active { background: #eee; }
        #pin-display { font-size: 2rem; letter-spacing: 10px; text-align: center; margin-bottom: 10px; height: 50px; background: #f0f0f0; border-radius: 8px; line-height: 50px;}
        .pin-msg { color: var(--danger); text-align: center; height: 20px; margin-top: 5px; font-weight: bold; }
        
        .upload-options { display: flex; gap: 10px; margin-top: 5px; flex-wrap: wrap;}
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="logo-area" style="border:none;">
        <img src="images/StarAcademyLogo.png" alt="Star Academy" class="logo-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
        <span class="logo-text" style="display:none; font-size:2rem;">STAR ACADEMY</span>
    </div>
    <div class="login-box">
        <h2>Classroom Caf√© Login</h2>
        <div id="loading-msg">Connecting to Database... <i class="fa-solid fa-spinner fa-spin"></i></div>
        <div class="login-grid hidden" id="login-buttons"></div>
    </div>
</div>

<div class="app-wrapper">
    <nav class="sidebar no-print">
        <div class="logo-area">
            <img src="images/StarAcademyLogo_notext.png" alt="Star Academy" class="logo-img" onerror="this.style.display='none'; this.nextElementSibling.style.display='block'">
            <span class="logo-text hidden">STAR ACADEMY</span>
        </div>
        <ul class="nav-links">
            <li onclick="app.navigate('pos')" id="nav-pos" class="active"><i class="fa-solid fa-mug-hot"></i> POS</li>
            <li onclick="app.navigate('barista')" id="nav-barista"><i class="fa-solid fa-bell"></i> Barista View</li>
            <li onclick="app.navigate('dashboard')" id="nav-dashboard"><i class="fa-solid fa-chart-line"></i> Dashboard</li>
            <li onclick="app.navigate('inventory')" id="nav-inventory"><i class="fa-solid fa-boxes-stacked"></i> Inventory</li>
            <li onclick="app.navigate('time')" id="nav-time"><i class="fa-solid fa-clock"></i> Time Clock</li>
        </ul>
        <div class="sidebar-footer">
            <div class="sidebar-version">v1.15</div>
            <button onclick="app.logout()" class="btn-sm" style="background:transparent; border:1px solid rgba(255,255,255,0.3); width:100%;">
                <i class="fa-solid fa-sign-out-alt"></i> Sign Out
            </button>
        </div>
    </nav>

    <div class="main-content">
        <header class="top-bar no-print">
            <div class="current-cashier-display" id="header-cashier">
                <i class="fa-solid fa-user-circle" style="margin-right: 10px;"></i> Not Logged In
            </div>
            <div style="display:flex; align-items:center; gap:15px;">
                <div id="cloud-status" title="Cloud Status">
                    <div id="status-dot" class="status-dot online"></div>
                    <span style="font-size:0.8rem">Cloud Sync</span>
                </div>
                <div id="live-clock">12:00 PM</div>
            </div>
        </header>

        <!-- POS -->
        <section id="view-pos" class="view active">
            <div class="pos-layout">
                <div class="product-section">
                    <div class="category-tabs" id="pos-categories"></div>
                    <div class="product-grid" id="pos-grid"></div>
                </div>
                <div class="cart-panel">
                    <div class="cart-header"><h3>Order #<span id="order-number"></span></h3></div>
                    <div style="padding: 15px 15px 0;"><input type="text" id="customer-name" class="form-control" placeholder="Customer Name"></div>
                    <div class="cart-items" id="cart-list"><div style="padding:20px; text-align:center; color:#999;">Cart is empty</div></div>
                    <div class="cart-totals">
                        <div class="total-row"><span>Subtotal</span> <span id="pos-subtotal">$0.00</span></div>
                        <div class="total-row"><span>Tax (9.25%)</span> <span id="pos-tax">$0.00</span></div>
                        <div class="total-row grand-total"><span>Total</span> <span id="pos-total">$0.00</span></div>
                    </div>
                    <div class="cart-actions">
                        <button class="btn-pay btn-cash" onclick="app.initiateCashPayment()"><i class="fa-solid fa-money-bill"></i> CASH</button>
                        <button class="btn-pay btn-card" onclick="app.processPayment('Card')"><i class="fa-regular fa-credit-card"></i> CARD</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- BARISTA -->
        <section id="view-barista" class="view"><h2 style="margin-bottom:20px; color:var(--space-indigo);">‚òï Barista Queue <button class="btn-sm" onclick="window.loadFromCloud(true)" style="float:right"><i class="fa-solid fa-rotate"></i> Refresh</button></h2><div class="barista-grid" id="barista-grid"></div></section>

        <!-- DASHBOARD -->
        <section id="view-dashboard" class="view">
            <div class="dash-header"><h2>Dashboard</h2><span id="dash-date"></span></div>
            <div class="stat-cards">
                <div class="stat-card"><i class="fa-solid fa-dollar-sign stat-icon"></i><div class="stat-data"><h3>Revenue</h3><p id="stat-revenue">$0.00</p></div></div>
                <div class="stat-card"><i class="fa-solid fa-receipt stat-icon"></i><div class="stat-data"><h3>Orders</h3><p id="stat-orders">0</p></div></div>
                <div class="stat-card"><i class="fa-solid fa-box-open stat-icon" style="color:var(--danger)"></i><div class="stat-data"><h3>Low Stock</h3><p id="stat-low">0</p></div></div>
            </div>
            <div class="recent-orders"><div class="ro-header">Recent Orders</div><table><thead><tr><th>Order #</th><th>Time</th><th>Customer</th><th>Cashier</th><th>Total</th><th>Status</th><th>Action</th></tr></thead><tbody id="dashboard-orders-body"></tbody></table></div>
        </section>

        <!-- INVENTORY (SMART) -->
        <section id="view-inventory" class="view">
            <div class="dash-header">
                <h2>Inventory</h2>
                <div id="inventory-actions"></div> <!-- JS injects buttons here if Manager -->
            </div>
            <div class="recent-orders"><table><thead><tr><th>Product</th><th>Category</th><th>Stock</th><th>Price</th><th>Status</th><th>Actions</th></tr></thead><tbody id="inventory-body"></tbody></table></div>
        </section>

        <!-- TIME -->
        <section id="view-time" class="view">
            <div class="clock-header"><div class="clock-time" id="big-clock">12:00:00 PM</div><div class="clock-date" id="big-date">Monday, January 1</div></div>
            <div class="clock-controls"><select id="time-employee-select" class="clock-select"><option value="">Select your name...</option></select><button class="btn-clock" style="background:var(--success)" onclick="app.clockIn()">Clock In</button><button class="btn-clock" style="background:var(--danger)" onclick="app.clockOut()">Clock Out</button></div>
            <div class="stat-cards">
                <div class="stat-card"><i class="fa-solid fa-users stat-icon"></i><div class="stat-data"><h3>Active</h3><p id="time-active-count">0</p></div></div>
                <div class="stat-card"><i class="fa-solid fa-clock stat-icon" style="color:var(--clock-orange)"></i><div class="stat-data"><h3>Hours (Week)</h3><p id="time-hours-week">0.0</p></div></div>
                <div class="stat-card"><i class="fa-regular fa-calendar stat-icon" style="color:#8e44ad"></i><div class="stat-data"><h3>Hours (Month)</h3><p id="time-hours-month">0.0</p></div></div>
            </div>
            <div class="recent-orders" style="margin-top:20px;"><h4>Currently Working</h4><div class="active-workers" id="active-workers-list"></div></div>
             <div class="recent-orders" style="margin-top:20px;"><h4>Recent Entries</h4><table><thead><tr><th>Name</th><th>Clock In</th><th>Clock Out</th><th>Hours</th></tr></thead><tbody id="time-entries-body"></tbody></table></div>
        </section>

        <!-- MANAGER HUB -->
        <section id="view-manager" class="view">
            <div class="dash-header"><h2><i class="fa-solid fa-lock"></i> Manager Hub</h2><div class="no-print"><button class="btn-sm" onclick="app.downloadFullBackup()" style="margin-right:10px;">üíæ Backup</button><button class="btn-sm" style="margin-right:10px;" onclick="window.loadFromCloud(true)">Sync Check</button><button class="btn-sm" style="background:var(--danger);" onclick="app.navigate('pos')">Exit</button></div></div>
            <div class="manager-box" style="margin-bottom: 20px; border-color: var(--danger); background: #fff5f5;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div><h3 style="color:var(--danger); margin-bottom:5px;">‚ö† "Go Live" - Day 1 Reset</h3><p style="font-size:0.9rem; color:#555;">Clear all practice data (Orders, Time Logs) but keep Employees and Menu.</p></div>
                    <button class="btn-pay" style="background:var(--danger); padding: 10px 20px;" onclick="app.goLiveReset()">Clear Data</button>
                </div>
            </div>
            <div class="manager-grid">
                <div class="manager-box">
                    <h3 style="margin-bottom:15px; color:var(--space-indigo);">System Log</h3>
                    <div class="bug-form no-print"><div class="form-group"><label>Type</label><select id="bug-type" class="form-control"><option>Bug / Error</option><option>Feature Request</option><option>Inventory Issue</option><option>Other</option></select></div><div class="form-group"><label>Details</label><textarea id="bug-details" placeholder="Describe..."></textarea></div><button class="btn-pay btn-gold" style="width:100%; padding:10px;" onclick="app.submitBugReport()">Submit Log</button></div>
                    <div style="margin-top:20px; border-top:1px solid #eee; padding-top:10px;"><h4 style="margin-bottom:10px;">Recent Logs</h4><div class="no-print" style="margin-bottom:10px;"><button class="btn-sm" onclick="app.printBugReports()">Print</button><button class="btn-sm" onclick="app.exportBugReports()">Export</button></div><div class="print-area"><table style="font-size:0.85rem;"><thead><tr><th>Time</th><th>Type</th><th>Details</th></tr></thead><tbody id="bug-log-body"></tbody></table></div></div>
                </div>
                <div style="display:flex; flex-direction:column; gap:20px;">
                    <div class="manager-box"><div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;"><h3>Products</h3><button class="btn-sm" onclick="app.openProductModal()">+ Add</button></div><div class="recent-orders" style="padding:0; box-shadow:none;"><table><thead><tr><th>Img</th><th>Name</th><th>Price</th><th>Act</th></tr></thead><tbody id="products-manager-body"></tbody></table></div></div>
                    <div class="manager-box"><div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;"><h3>Employees</h3><button class="btn-sm" onclick="app.openEmployeeModal()">+ Add</button></div><div class="recent-orders" style="padding:0; box-shadow:none;"><table><thead><tr><th>Pic</th><th>Name</th><th>Role</th><th>Act</th></tr></thead><tbody id="employees-body"></tbody></table></div></div>
                </div>
            </div>
        </section>

        <!-- IT HUB -->
        <section id="view-it" class="view">
            <div class="dash-header">
                <h2 style="color:var(--space-indigo)"><i class="fa-solid fa-microchip"></i> IT Administration</h2>
                <button class="btn-sm" style="background:var(--danger);" onclick="app.navigate('pos')">Exit</button>
            </div>
            <div class="manager-grid">
                <div class="manager-box" style="border-top-color: var(--barista-purple)">
                    <h3><i class="fa-solid fa-database"></i> Data Management</h3>
                    <p style="font-size:0.9rem; margin-bottom:15px">Advanced controls for IT Support.</p>
                    <button class="btn-pay btn-card" style="width:100%; margin-bottom:10px" onclick="window.loadFromCloud(true)">Force Cloud Sync</button>
                    <button class="btn-pay" style="width:100%; margin-bottom:10px; background:#555" onclick="app.downloadFullBackup()">Download Full JSON Backup</button>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:10px;">
                        <button class="btn-pay btn-gold" onclick="app.exportBugReports()">Export Logs CSV</button>
                        <button class="btn-pay btn-gold" onclick="app.printBugReports()">Print Logs</button>
                    </div>
                    <hr style="margin:20px 0;">
                    <h4 style="color:var(--danger)">Danger Zone</h4>
                    <button class="btn-pay" style="background:var(--danger); width:100%" onclick="app.nuclearReset()">‚ò¢Ô∏è WIPE LOCAL STORAGE</button>
                </div>
                <div class="manager-box">
                    <h3>Manager Tools Access</h3>
                    <p>IT Admin has full access to Manager functions.</p>
                    <button class="btn-sm" onclick="app.navigate('manager')">Go to Manager Hub</button>
                    <h3 style="margin-top:20px;">System Status</h3>
                    <p><strong>Version:</strong> v1.15 (Real-Time)</p>
                    <p><strong>DB Connection:</strong> <span id="it-db-status">Active</span></p>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- MODALS -->
<div id="modal-pin" class="modal">
    <div class="modal-content" style="width:300px;">
        <h3>Enter Access PIN</h3>
        <div id="pin-display"></div>
        <div id="pin-pad-grid">
            <button class="pin-btn" onclick="app.pinInput('1')">1</button><button class="pin-btn" onclick="app.pinInput('2')">2</button><button class="pin-btn" onclick="app.pinInput('3')">3</button>
            <button class="pin-btn" onclick="app.pinInput('4')">4</button><button class="pin-btn" onclick="app.pinInput('5')">5</button><button class="pin-btn" onclick="app.pinInput('6')">6</button>
            <button class="pin-btn" onclick="app.pinInput('7')">7</button><button class="pin-btn" onclick="app.pinInput('8')">8</button><button class="pin-btn" onclick="app.pinInput('9')">9</button>
            <button class="pin-btn" onclick="app.pinClear()" style="color:var(--danger)">C</button><button class="pin-btn" onclick="app.pinInput('0')">0</button><button class="pin-btn" onclick="app.pinSubmit()" style="background:var(--success); color:white;">OK</button>
        </div>
        <div id="pin-error" class="pin-msg"></div>
        <button class="btn-sm" style="margin-top:20px; width:100%;" onclick="app.closeModal('modal-pin')">Cancel</button>
    </div>
</div>

<div id="modal-options" class="modal"><div class="modal-content"><h3 id="opt-modal-title">Customize Item</h3><div id="opt-dynamic-container"></div><div class="opt-group-title">Custom Note</div><input type="text" id="opt-custom-note" class="custom-note-input" placeholder="e.g. Allergy info..."><div style="margin-top:20px; display:flex; gap:10px;"><button class="btn-pay btn-train" style="flex:1" onclick="app.closeModal('modal-options')">Cancel</button><button class="btn-pay btn-gold" style="flex:1" onclick="app.confirmOptions()">Add to Order</button></div></div></div>
<div id="modal-cash" class="modal"><div class="modal-content"><h3>Cash Payment</h3><p>Total Due: <strong id="cash-modal-total" style="font-size:1.2rem">$0.00</strong></p><div style="margin:15px 0;"><label>Amount Tendered:</label><div id="calc-display" class="calc-display">$0.00</div></div><div id="change-result" class="change-result">Change Due: <span id="change-amt">$0.00</span></div><div class="calc-grid"><button class="calc-btn" onclick="app.calcInput(1)">1</button><button class="calc-btn" onclick="app.calcInput(2)">2</button><button class="calc-btn" onclick="app.calcInput(3)">3</button><button class="calc-btn" onclick="app.calcInput(4)">4</button><button class="calc-btn" onclick="app.calcInput(5)">5</button><button class="calc-btn" onclick="app.calcInput(6)">6</button><button class="calc-btn" onclick="app.calcInput(7)">7</button><button class="calc-btn" onclick="app.calcInput(8)">8</button><button class="calc-btn" onclick="app.calcInput(9)">9</button><button class="calc-btn" onclick="app.calcInput('.')">.</button><button class="calc-btn" onclick="app.calcInput(0)">0</button><button class="calc-btn" style="color:var(--danger)" onclick="app.calcClear()">C</button></div><div class="calc-grid" style="grid-template-columns: 1fr 1fr 1fr;"><button class="calc-btn" style="font-size:1rem; background:#e0e0e0" onclick="app.calcExact()">Exact</button><button class="calc-btn" style="font-size:1rem; background:#e0e0e0" onclick="app.calcNext(5)">$5</button><button class="calc-btn" style="font-size:1rem; background:#e0e0e0" onclick="app.calcNext(10)">$10</button></div><div style="display:flex; gap:10px;"><button class="btn-pay btn-train" style="flex:1" onclick="app.closeModal('modal-cash')">Cancel</button><button class="btn-pay btn-cash" style="flex:1" onclick="app.finalizeCash()">Finalize</button></div></div></div>
<div id="modal-receipt" class="modal"><div class="modal-content"><h3 class="no-print" style="text-align:center; color:var(--space-indigo); padding-top:20px;">Order Complete!</h3><div class="receipt-paper" id="receipt-content"></div><div class="no-print" style="display:flex; gap:10px; padding:20px;"><button class="btn-pay btn-train" style="flex:1" onclick="window.print()">Print</button><button class="btn-pay btn-card" style="flex:1" onclick="app.closeReceiptAndReset()">Close</button></div></div></div>
<div id="modal-edit-inventory" class="modal"><div class="modal-content"><h3>Edit Inventory</h3><div class="form-group"><label id="edit-inv-name">Product Name</label></div><div class="form-group"><label>Current Stock</label><input type="number" id="edit-inv-stock" class="form-control"></div><div class="form-group"><label>Price ($)</label><input type="number" id="edit-inv-price" class="form-control" step="0.25"></div><div style="display:flex; gap:10px;"><button class="btn-pay btn-train" style="flex:1" onclick="app.closeModal('modal-edit-inventory')">Cancel</button><button class="btn-pay btn-gold" style="flex:1" onclick="app.saveInventory()">Save</button></div></div></div>
<div id="modal-product" class="modal"><div class="modal-content" style="max-width: 600px;"><h3 id="prod-modal-title">Add/Edit Product</h3><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;"><div><div class="form-group"><label>Name</label><input type="text" id="prod-name" class="form-control"></div><div class="form-group"><label>Category</label><select id="prod-cat" class="form-control"><option>Beverages</option><option>Baked Goods</option><option>Snacks</option></select></div><div class="form-group"><label>Price</label><input type="number" id="prod-price" class="form-control" step="0.25"></div><div class="form-group"><label>Stock</label><input type="number" id="prod-stock" class="form-control"></div><div class="form-group"><label>Image URL</label><input type="text" id="prod-img-url" class="form-control" placeholder="https://..."></div><div class="upload-options"><input type="file" id="prod-img-file" accept="image/*" onchange="app.handleImageUpload(this, 'prod-img-url')"><button class="btn-sm" onclick="app.generateAIImage('prod-name','prod-img-url')">AI Gen</button></div></div><div><label style="font-weight:600; color:var(--space-indigo);">Product Options</label><div id="prod-options-list" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-bottom: 10px;"></div><button class="btn-sm" onclick="app.addProductOptionUI()">+ Add Option Group</button></div></div><div style="display:flex; gap:10px; margin-top: 20px;"><button class="btn-pay btn-train" style="flex:1" onclick="app.closeModal('modal-product')">Cancel</button><button class="btn-pay btn-gold" style="flex:1" onclick="app.saveProduct()">Save Product</button></div></div></div>
<div id="modal-employee" class="modal"><div class="modal-content"><h3 id="emp-modal-title">Add/Edit Employee</h3><div class="form-group"><label>Name</label><input type="text" id="emp-name" class="form-control"></div><div class="form-group"><label>Role</label><select id="emp-role" class="form-control"><option>Cashier</option><option>Barista</option><option>Inventory</option><option>Manager</option><option>IT Admin</option></select></div><div class="form-group"><label>Photo URL</label><input type="text" id="emp-img-url" class="form-control" placeholder="https://..."></div><div class="upload-options"><input type="file" id="emp-img-file" accept="image/*" onchange="app.handleImageUpload(this, 'emp-img-url')"></div><div style="display:flex; gap:10px;"><button class="btn-pay btn-train" style="flex:1" onclick="app.closeModal('modal-employee')">Cancel</button><button class="btn-pay btn-gold" style="flex:1" onclick="app.saveEmployee()">Save</button></div></div></div>

<!-- FIREBASE SDK -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBt6HIzo_onaft9h-RiwROnsfv3otXKB20",
      authDomain: "star-academy-cafe-pos.firebaseapp.com",
      projectId: "star-academy-cafe-pos",
      storageBucket: "star-academy-cafe-pos.firebasestorage.app",
      messagingSenderId: "148643314098",
      appId: "1:148643314098:web:fd730b7d111f5fd374ccab",
      measurementId: "G-Y61XRHTJ3Y"
    };

    const fbApp = initializeApp(firebaseConfig);
    const db = getFirestore(fbApp);
    const docRef = doc(db, "stores", "classroom_cafe_main");

    let unsubscribe = null;

    window.saveToCloud = async (data, silent = false) => {
        const dot = document.getElementById('status-dot');
        if (!silent) dot.className = 'status-dot syncing';
        try {
            await setDoc(docRef, data);
            if (!silent) setTimeout(() => dot.className = 'status-dot online', 500);
        } catch (e) {
            console.error("Save Error", e);
            if (!silent) dot.className = 'status-dot error';
        }
    };

    window.loadFromCloud = (manual = false) => {
        const dot = document.getElementById('status-dot');
        const itStatus = document.getElementById('it-db-status');
        if (manual) dot.className = 'status-dot syncing';

        if (!unsubscribe) {
            unsubscribe = onSnapshot(docRef, (doc) => {
                if (doc.exists()) {
                    console.log("Real-time update received!");
                    app.data = doc.data();
                    app.refreshUI();
                    if(document.getElementById('loading-msg')) {
                        document.getElementById('loading-msg').style.display = 'none';
                        document.getElementById('login-buttons').classList.remove('hidden');
                        app.renderLogin();
                    }
                    dot.className = 'status-dot online';
                    if (itStatus) itStatus.innerText = "Connected (Real-Time Listening)";
                }
            }, (error) => {
                console.error("Listen Error", error);
                dot.className = 'status-dot error';
                if (itStatus) itStatus.innerText = "Error (Check Console)";
                document.getElementById('loading-msg').innerHTML = "Offline Mode (Local Data Only)";
                document.getElementById('login-buttons').classList.remove('hidden');
                app.renderLogin();
            });
        }
    };
    
    window.loadFromCloud();
</script>

<script>
// --- AUDIO SYSTEM ---
const playTone = (freq, type, duration) => {
    try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = type; osc.frequency.setValueAtTime(freq, ctx.currentTime);
        gain.gain.setValueAtTime(0.1, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + duration);
        osc.connect(gain); gain.connect(ctx.destination);
        osc.start(); osc.stop(ctx.currentTime + duration);
    } catch (e) { console.log("Audio not supported"); }
};

const app = {
    data: {
        currentCashier: null, cart: [], products: [], orders: [], employees: [], timeEntries: [], bugReports: [], orderCounter: 1001, taxRate: 0.0925, tempProduct: null, tempOptions: {}, tempCashEntry: "", editingId: null, 
    },
    pinBuffer: "",
    pinCallback: null,

    init: () => {
        app.loadLocalData(); 
        setInterval(app.updateClock, 1000);
        document.getElementById('order-number').innerText = app.data.orderCounter;
    },

    refreshUI: () => {
        document.getElementById('order-number').innerText = app.data.orderCounter;
        app.renderLogin();
        const active = document.querySelector('.view.active').id;
        if(active === 'view-pos') app.renderPOS();
        if(active === 'view-barista') app.renderBarista();
        if(active === 'view-dashboard') app.renderDashboard();
        if(active === 'view-inventory') app.renderInventory();
    },

    loadLocalData: () => {
        const stored = localStorage.getItem('starAcademyPOS_v115');
        if (stored) {
            app.data = JSON.parse(stored);
        } else {
            app.seedData();
        }
    },

    saveData: () => { 
        localStorage.setItem('starAcademyPOS_v115', JSON.stringify(app.data));
        if(window.saveToCloud) window.saveToCloud(app.data, true); 
    },

    seedData: () => {
        app.data.products = [
            { id: 1, name: "Coffee", cat: "Beverages", price: 3.50, stock: 50, img: "images/coffee.jpg", options: [{ name: "Add-ins", type: "select", choices: [{name:"Half & Half"}, {name:"Extra Room"}, {name:"Decaf"}] }] },
            { id: 2, name: "Herbal Tea", cat: "Beverages", price: 3.25, stock: 40, img: "https://images.unsplash.com/photo-1597481499750-3e6b22637e12?w=200", options: [{ name: "Temp", type: "toggle", choice: {name:"Not too hot"} }] },
            { id: 3, name: "Black Tea", cat: "Beverages", price: 3.25, stock: 40, img: "https://images.unsplash.com/photo-1597481499750-3e6b22637e12?w=200", options: [{ name: "Temp", type: "toggle", choice: {name:"Not too hot"} }] },
            { id: 4, name: "Iced Tea", cat: "Beverages", price: 3.75, stock: 35, img: "https://images.unsplash.com/photo-1499638673689-79a0b5115d87?w=200", options: [{ name: "Ice Level", type: "radio", choices: [{name:"No Ice"}, {name:"Low Ice"}, {name:"Extra Ice"}] }] },
            { id: 5, name: "Hot Chocolate", cat: "Beverages", price: 4.00, stock: 30, img: "https://images.unsplash.com/photo-1542990253-0d0f5be5f0ed?w=200", options: [{ name: "Temp", type: "toggle", choice: {name:"Not too hot"} }, { name: "Topping", type: "toggle", choice: {name:"Whipped Cream"} }] },
            { id: 6, name: "Hot Cider", cat: "Beverages", price: 3.75, stock: 30, img: "https://via.placeholder.com/150?text=Cider", options: [{ name: "Temp", type: "toggle", choice: {name:"Not too hot"} }] },
            { id: 7, name: "Latte", cat: "Beverages", price: 4.50, stock: 40, img: "https://via.placeholder.com/150?text=Latte", options: [{ name: "Syrup", type: "select", choices: [{name:"Plain"}, {name:"Vanilla"}, {name:"Hazelnut"}] }, { name: "Temp", type: "toggle", choice: {name:"Not too hot"} }, { name: "Topping", type: "toggle", choice: {name:"Whipped Cream"} }] },
            { id: 8, name: "Blueberry Muffin", cat: "Baked Goods", price: 3.75, stock: 20, img: "images/muffin.jpg" },
            { id: 9, name: "Chocolate Muffin", cat: "Baked Goods", price: 3.75, stock: 20, img: "https://images.unsplash.com/photo-1607958996333-41aef7caefaa?w=200" },
            { id: 10, name: "Choc Chip Cookie", cat: "Baked Goods", price: 2.50, stock: 30, img: "https://images.unsplash.com/photo-1499636138143-bd630f5cf38a?w=200" },
            { id: 11, name: "Biscotti", cat: "Baked Goods", price: 2.00, stock: 25, img: "https://via.placeholder.com/150?text=Biscotti" },
            { id: 12, name: "Plain Bagel", cat: "Baked Goods", price: 3.00, stock: 15, img: "https://via.placeholder.com/150?text=Bagel", options: [{ name: "Prep", type: "toggle", choice: {name:"Toasted"} }, { name: "Add-on", type: "toggle", choice: {name:"Cream Cheese", price: 1.00} }] },
            { id: 13, name: "Bottled Water", cat: "Beverages", price: 1.50, stock: 50, img: "https://images.unsplash.com/photo-1603394630854-e0b62d294e33?w=200" },
            { id: 14, name: "Tap Water", cat: "Beverages", price: 0.00, stock: 100, img: "https://images.unsplash.com/photo-1548839140-29a749e1cf4d?w=200" }
        ];
        // v1.15: Updated Roster
        app.data.employees = [
            {id: 1, name: "Manager", role: "Manager", img: "images/placeholder.png"},
            {id: 2, name: "Alex", role: "Cashier", img: "images/placeholder.png"},
            {id: 3, name: "Brianna", role: "Barista", img: "images/placeholder.png"},
            {id: 4, name: "Jordan", role: "Inventory", img: "images/placeholder.png"},
            {id: 5, name: "Maya", role: "Cashier", img: "images/placeholder.png"},
            {id: 6, name: "Noah", role: "Barista", img: "images/placeholder.png"},
            {id: 7, name: "Zoe", role: "Floater", img: "images/placeholder.png"},
            {id: 8, name: "IT Support", role: "IT Admin", img: "images/placeholder.png"}
        ];
        app.data.orderCounter = 1001;
        app.data.orders = [];
        app.data.timeEntries = [];
        app.data.bugReports = [];
        app.saveData();
    },

    // --- GO LIVE RESET ---
    goLiveReset: () => {
        if(confirm("‚ö† WARNING: Clear practice data? Employees/Menu kept.")) {
            app.requestPin((pin) => {
                if(pin === "1234") {
                    app.data.orders = []; app.data.timeEntries = []; app.data.bugReports = []; app.data.cart = [];
                    app.data.orderCounter = 1001; app.saveData(); app.refreshUI(); alert("Reset Complete.");
                } else alert("Incorrect PIN.");
            });
        }
    },
    
    // --- IT FUNCTIONS ---
    nuclearReset: () => {
        if(confirm("‚ö† DANGER: This will wipe LOCAL storage completely. If you are offline, you lose everything.")) {
            app.requestPin((pin) => {
                if(pin === "9753") {
                    localStorage.removeItem('starAcademyPOS_v115');
                    location.reload();
                } else alert("Incorrect PIN");
            });
        }
    },

    // --- AUTH ---
    renderLogin: () => {
        const c = document.getElementById('login-buttons');
        c.innerHTML = app.data.employees.map(e => `
            <div class="login-btn-wrap" onclick="app.login('${e.name}')">
                <img src="${e.img}" class="login-btn-img" onerror="this.src='images/placeholder.png'">
                <span class="login-btn-name">${e.name}</span>
            </div>
        `).join('');
    },
    login: (name) => {
        const emp = app.data.employees.find(e => e.name === name);
        const proceed = () => {
            app.data.currentCashier = name;
            const imgUrl = emp ? emp.img : 'images/placeholder.png';
            document.getElementById('header-cashier').innerHTML = `<img src="${imgUrl}" class="cashier-avatar" onerror="this.src='images/placeholder.png'"> ${name}`;
            document.getElementById('login-overlay').style.display = 'none';
            app.navigate('pos');
        };

        if (emp.role === "Manager" || emp.role === "IT Admin") {
            app.requestPin((pin) => {
                if ((emp.role === "Manager" && pin === "1234") || (emp.role === "IT Admin" && pin === "9753")) {
                    proceed();
                } else {
                    document.getElementById('pin-error').innerText = "Incorrect PIN";
                }
            });
        } else {
            proceed();
        }
    },
    logout: () => {
        app.data.currentCashier = null;
        document.getElementById('login-overlay').style.display = 'flex';
    },

    // --- CUSTOM PIN PAD LOGIC ---
    requestPin: (callback) => {
        app.pinBuffer = "";
        app.pinCallback = callback;
        document.getElementById('pin-display').innerText = "";
        document.getElementById('pin-error').innerText = "";
        document.getElementById('modal-pin').classList.add('open');
    },
    pinInput: (num) => {
        app.pinBuffer += num;
        document.getElementById('pin-display').innerText = "*".repeat(app.pinBuffer.length);
    },
    pinClear: () => {
        app.pinBuffer = "";
        document.getElementById('pin-display').innerText = "";
    },
    pinSubmit: () => {
        document.getElementById('modal-pin').classList.remove('open');
        if (app.pinCallback) app.pinCallback(app.pinBuffer);
    },

    navigate: (viewId) => {
        document.querySelectorAll('.view').forEach(e => e.classList.remove('active'));
        document.querySelectorAll('.nav-links li').forEach(e => e.classList.remove('active'));
        const navItem = document.getElementById(`nav-${viewId}`);
        if(navItem) navItem.classList.add('active');
        document.getElementById(`view-${viewId}`).classList.add('active');
        
        if(viewId === 'pos') app.renderPOS();
        if(viewId === 'dashboard') app.renderDashboard();
        if(viewId === 'barista') app.renderBarista();
        if(viewId === 'inventory') app.renderInventory();
        if(viewId === 'time') app.renderTimeClock();
        if(viewId === 'manager') app.renderManagerHub();
    },

    checkManagerAccess: () => {
        app.requestPin((pin) => {
            if(pin === "1234") app.navigate('manager');
            else if(pin === "9753") app.navigate('it');
            else alert("Incorrect PIN");
        });
    },

    // --- IMAGE HANDLING ---
    handleImageUpload: (input, targetId) => {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById(targetId).value = e.target.result; // Base64
            };
            reader.readAsDataURL(input.files[0]);
        }
    },
    generateAIImage: (nameId, targetId) => {
        const query = document.getElementById(nameId).value || 'coffee';
        const url = `https://loremflickr.com/200/200/${encodeURIComponent(query)}/all`; 
        document.getElementById(targetId).value = url;
    },

    // --- MANAGER/IT HUB ---
    renderManagerHub: () => { app.renderBugReports(); app.renderProductsManager(); app.renderEmployeesManager(); },
    renderBugReports: () => {
        const tbody = document.getElementById('bug-log-body');
        const logs = [...app.data.bugReports].reverse();
        tbody.innerHTML = logs.length ? logs.slice(0,5).map(l => `<tr><td style="font-size:0.8rem; white-space:nowrap;">${new Date(l.date).toLocaleDateString()}</td><td><b>${l.type}</b></td><td>${l.details}</td></tr>`).join('') : '<tr><td colspan="3">No logs.</td></tr>';
    },
    submitBugReport: () => {
        const type = document.getElementById('bug-type').value; const details = document.getElementById('bug-details').value;
        if(!details) return alert("Details required.");
        app.data.bugReports.push({id: Date.now(), date: new Date().toISOString(), type, details});
        document.getElementById('bug-details').value = ""; app.saveData(); app.renderBugReports(); alert("Log saved.");
    },
    exportBugReports: () => {
        let csv = "Date,Type,Details\n"; app.data.bugReports.forEach(l => { csv += `"${l.date}","${l.type}","${l.details.replace(/"/g, '""')}"\n`; });
        const blob = new Blob([csv], { type: 'text/csv' }); const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = `StarAcademy_Logs_${new Date().toISOString().split('T')[0]}.csv`; a.click();
    },
    printBugReports: () => { window.print(); },
    downloadFullBackup: () => {
        const dataStr = JSON.stringify(app.data); const blob = new Blob([dataStr], {type: "application/json"}); const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = `star_academy_backup_${new Date().toISOString().split('T')[0]}.json`; a.click();
        alert("Backup file downloaded.");
    },

    // --- POS ---
    renderPOS: (cat = 'All') => {
        const cats = ['All', ...new Set(app.data.products.map(p => p.cat))];
        document.getElementById('pos-categories').innerHTML = cats.map(c => `<button class="cat-tab ${c === cat ? 'active' : ''}" onclick="app.renderPOS('${c}')">${c}</button>`).join('');
        document.getElementById('pos-grid').innerHTML = app.data.products.filter(p => cat === 'All' || p.cat === cat).map(p => `
            <div class="product-card" onclick="app.addToCartClick(${p.id})">
                <div class="p-image" style="background-image:url('${p.img}')"></div>
                <div class="p-info"><div class="p-name">${p.name}</div><div class="p-price">$${p.price.toFixed(2)}</div></div>
            </div>`).join('');
        app.renderCart();
    },
    addToCartClick: (id) => {
        playTone(600, 'sine', 0.1); 
        app.data.tempProduct = app.data.products.find(p => p.id === id);
        document.getElementById('opt-modal-title').innerText = app.data.tempProduct.name;
        document.getElementById('opt-custom-note').value = "";
        const container = document.getElementById('opt-dynamic-container'); container.innerHTML = ''; app.data.tempOptions = {};
        if (app.data.tempProduct.options && app.data.tempProduct.options.length > 0) {
            app.data.tempProduct.options.forEach((optGroup) => {
                const groupDiv = document.createElement('div'); groupDiv.innerHTML = `<div class="opt-group-title">${optGroup.name}</div>`;
                const buttonsDiv = document.createElement('div'); buttonsDiv.className = 'opt-buttons';
                if (optGroup.type === 'select' || optGroup.type === 'radio') {
                    optGroup.choices.forEach(choice => {
                        const btn = document.createElement('button'); btn.className = 'opt-btn';
                        btn.innerText = choice.name + (choice.price ? ` (+$${choice.price.toFixed(2)})` : '');
                        btn.onclick = () => { buttonsDiv.querySelectorAll('.opt-btn').forEach(b => b.classList.remove('selected')); btn.classList.add('selected'); app.data.tempOptions[optGroup.name] = choice; };
                        buttonsDiv.appendChild(btn);
                    });
                } else if (optGroup.type === 'toggle') {
                    const btn = document.createElement('button'); btn.className = 'opt-btn';
                    btn.innerText = optGroup.choice.name + (optGroup.choice.price ? ` (+$${optGroup.choice.price.toFixed(2)})` : '');
                    btn.onclick = () => { btn.classList.toggle('selected'); if (btn.classList.contains('selected')) { app.data.tempOptions[optGroup.name] = optGroup.choice; } else { delete app.data.tempOptions[optGroup.name]; } };
                    buttonsDiv.appendChild(btn);
                }
                groupDiv.appendChild(buttonsDiv); container.appendChild(groupDiv);
            });
        } else { container.innerHTML = '<p style="color:#777; font-style:italic;">No options.</p>'; }
        document.getElementById('modal-options').classList.add('open');
    },
    confirmOptions: () => {
        const note = document.getElementById('opt-custom-note').value;
        let optionsString = ""; let addedPrice = 0;
        for (const key in app.data.tempOptions) { const choice = app.data.tempOptions[key]; if (optionsString) optionsString += ", "; optionsString += choice.name; if (choice.price) addedPrice += choice.price; }
        const fullNotes = [optionsString, note].filter(Boolean).join('. Note: ');
        const finalPrice = app.data.tempProduct.price + addedPrice;
        const exist = app.data.cart.find(i => i.id === app.data.tempProduct.id && i.notes === fullNotes && i.price === finalPrice);
        if(exist) { exist.qty++; } else { app.data.cart.push({ ...app.data.tempProduct, qty: 1, notes: fullNotes, price: finalPrice, baseId: app.data.tempProduct.id }); }
        app.closeModal('modal-options'); app.renderCart();
    },
    renderCart: () => {
        const list = document.getElementById('cart-list');
        list.innerHTML = app.data.cart.length ? app.data.cart.map((i, idx) => `
            <div class="cart-item">
                <div class="item-info"><h4>${i.name}</h4><div class="opts">${i.notes || ''}</div></div>
                <div class="qty-control"><button class="btn-qty" onclick="app.adjQty(${idx}, -1)">-</button><span>${i.qty}</span><button class="btn-qty" onclick="app.adjQty(${idx}, 1)">+</button><button class="btn-del" onclick="app.adjQty(${idx}, -999)"><i class="fa-solid fa-trash"></i></button></div>
            </div>`).join('') : `<div style="padding:20px; text-align:center; color:#999;">Cart is empty</div>`;
        const sub = app.data.cart.reduce((s, i) => s + (i.price * i.qty), 0);
        document.getElementById('pos-subtotal').innerText = `$${sub.toFixed(2)}`; document.getElementById('pos-tax').innerText = `$${(sub * app.data.taxRate).toFixed(2)}`; document.getElementById('pos-total').innerText = `$${(sub * (1 + app.data.taxRate)).toFixed(2)}`;
    },
    adjQty: (i, d) => { app.data.cart[i].qty += d; if(app.data.cart[i].qty <= 0) app.data.cart.splice(i, 1); app.renderCart(); },

    // --- PAYMENTS ---
    initiateCashPayment: () => {
        if(!app.data.cart.length) return alert("Empty");
        const total = app.data.cart.reduce((s, i) => s + i.price * i.qty, 0) * (1 + app.data.taxRate);
        document.getElementById('cash-modal-total').innerText = `$${total.toFixed(2)}`;
        app.data.tempCashEntry = ""; document.getElementById('calc-display').innerText = "$0.00"; document.getElementById('change-result').style.display = 'none';
        document.getElementById('modal-cash').classList.add('open');
    },
    calcInput: (v) => { if(v==='.' && app.data.tempCashEntry.includes('.')) return; app.data.tempCashEntry += v; app.updateCalc(); },
    calcClear: () => { app.data.tempCashEntry = ""; app.updateCalc(); },
    calcExact: () => { const t = app.data.cart.reduce((s,i)=>s+i.price*i.qty,0)*(1+app.data.taxRate); app.data.tempCashEntry = t.toFixed(2); app.updateCalc(); },
    calcNext: (n) => { app.data.tempCashEntry = n.toString(); app.updateCalc(); },
    updateCalc: () => {
        const val = parseFloat(app.data.tempCashEntry) || 0; document.getElementById('calc-display').innerText = `$${val.toFixed(2)}`;
        const total = app.data.cart.reduce((s,i)=>s+i.price*i.qty,0)*(1+app.data.taxRate);
        const change = val - total;
        document.getElementById('change-result').style.display = change >= 0 ? 'block' : 'none'; document.getElementById('change-amt').innerText = `$${change.toFixed(2)}`;
    },
    finalizeCash: () => {
        const total = app.data.cart.reduce((s,i)=>s+i.price*i.qty,0)*(1+app.data.taxRate);
        const tender = parseFloat(app.data.tempCashEntry); if(tender < total - 0.01) return alert("Insufficient funds.");
        app.processPayment('Cash', tender, tender-total);
    },
    processPayment: (type, tender=0, change=0) => {
        if(!app.data.cart.length) return;
        const customerName = document.getElementById('customer-name').value.trim();
        const sub = app.data.cart.reduce((s,i)=>s+i.price*i.qty,0);
        const order = {
            id: app.data.orderCounter++, date: new Date().toISOString(), cashier: app.data.currentCashier, customer: customerName || "Walk-in",
            items: [...app.data.cart], sub, tax: sub*app.data.taxRate, total: sub*(1+app.data.taxRate), type, tender, change, status: 'Pending'
        };
        order.items.forEach(i => { const p = app.data.products.find(x => x.id === (i.baseId || i.id)); if(p) p.stock -= i.qty; });
        app.data.orders.push(order); app.saveData(); app.closeModal('modal-cash'); app.showReceipt(order);
        document.getElementById('order-number').innerText = app.data.orderCounter; document.getElementById('customer-name').value = "";
        playTone(1200, 'square', 0.1); setTimeout(() => playTone(1600, 'square', 0.2), 100);
    },

    // --- RECEIPT/BARISTA/DASHBOARD ---
    showReceipt: (o) => {
        const d = new Date(o.date);
        document.getElementById('receipt-content').innerHTML = `
            <div class="r-center"><h3>STAR ACADEMY CAFE</h3><p>${d.toLocaleDateString()} ${d.toLocaleTimeString()}</p><p>Order #: ${o.id}</p><p>Cashier: ${o.cashier}</p><p>Customer: ${o.customer}</p></div>
            <div class="r-line"></div>
            ${o.items.map(i => `<div class="r-row"><span>${i.qty}x ${i.name}</span><span>$${(i.price*i.qty).toFixed(2)}</span></div>${i.notes?`<div style="font-size:0.8rem;font-style:italic">- ${i.notes}</div>`:''}`).join('')}
            <div class="r-line"></div>
            <div class="r-row"><span>Subtotal</span><span>$${o.sub.toFixed(2)}</span></div><div class="r-row"><span>Tax</span><span>$${o.tax.toFixed(2)}</span></div><div class="r-row r-total"><span>TOTAL</span><span>$${o.total.toFixed(2)}</span></div>
            ${o.type==='Cash'?`<div class="r-line"></div><div class="r-row"><span>Cash</span><span>$${o.tender.toFixed(2)}</span></div><div class="r-row"><span>Change</span><span>$${o.change.toFixed(2)}</span></div>`: `<div class="r-center" style="margin-top:10px;">Paid: ${o.type}</div>`}
            <div class="r-center" style="margin-top:20px;">Thank You!</div>
        `;
        document.getElementById('modal-receipt').classList.add('open');
    },
    closeReceiptAndReset: () => { app.data.cart = []; app.closeModal('modal-receipt'); app.renderCart(); },
    renderBarista: () => {
        const pending = app.data.orders.filter(o => o.status === 'Pending').reverse();
        document.getElementById('barista-grid').innerHTML = pending.length ? pending.map(o => `
            <div class="order-card"><div class="oc-header"><div class="oc-title"><span>#${o.id}</span><span>${new Date(o.date).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</span></div><div class="oc-customer"><i class="fa-solid fa-user"></i> ${o.customer}</div></div>
            <div class="oc-body">${o.items.map(i => `<div class="oc-item"><div class="oc-item-name">${i.qty}x ${i.name}</div>${i.notes?`<span class="oc-opts">${i.notes}</span>`:''}</div>`).join('')}</div>
            <div class="oc-footer"><button class="btn-ready" onclick="app.markReady(${o.id})">Mark Ready</button></div></div>`).join('') : '<p>No orders.</p>';
    },
    markReady: (id) => { app.data.orders.find(o => o.id === id).status = 'Completed'; app.saveData(); app.renderBarista(); },
    renderDashboard: () => {
        const rev = app.data.orders.reduce((s, o) => s + o.total, 0);
        document.getElementById('stat-revenue').innerText = `$${rev.toFixed(2)}`;
        document.getElementById('stat-orders').innerText = app.data.orders.length;
        document.getElementById('stat-low').innerText = app.data.products.filter(p => p.stock < 10).length;
        const recent = [...app.data.orders].reverse().slice(0, 10);
        document.getElementById('dashboard-orders-body').innerHTML = recent.map(o => `<tr><td>#${o.id}</td><td>${new Date(o.date).toLocaleTimeString()}</td><td>${o.customer}</td><td>${o.cashier}</td><td>$${o.total.toFixed(2)}</td><td>${o.status}</td><td><button class="btn-sm" onclick="app.showReceiptById(${o.id})">Receipt</button></td></tr>`).join('');
    },
    showReceiptById: (id) => { app.showReceipt(app.data.orders.find(o => o.id === id)); },

    // --- OTHER VIEWS ---
    renderInventory: () => {
        const role = app.getRole();
        const isManager = (role === 'Manager' || role === 'IT Admin');
        
        let headerHtml = '<h2>Inventory</h2>';
        if (isManager) {
            headerHtml += '<button class="btn-sm" onclick="app.openProductModal()">+ Add Item</button>';
        }
        document.querySelector('#view-inventory .dash-header').innerHTML = headerHtml;

        document.getElementById('inventory-body').innerHTML = app.data.products.map(p => `
            <tr>
                <td>${p.name}</td>
                <td>${p.cat}</td>
                <td><b>${p.stock}</b></td>
                <td>$${p.price.toFixed(2)}</td>
                <td><span class="status-badge ${p.stock<10?'stock-low':'stock-ok'}">${p.stock<10?'Low':'OK'}</span></td>
                <td>
                    <button class="btn-sm" onclick="app.inventoryEditClick(${p.id})">Edit</button>
                    ${isManager ? `<button class="btn-sm btn-danger-sm" onclick="app.deleteProduct(${p.id})">X</button>` : ''}
                </td>
            </tr>`).join('');
    },
    getRole: () => {
        const emp = app.data.employees.find(e => e.name === app.data.currentCashier);
        return emp ? emp.role : 'Student';
    },
    inventoryEditClick: (id) => {
        const role = app.getRole();
        if (role === 'Manager' || role === 'IT Admin') {
            app.editProduct(id); // Full Editor
        } else {
            app.editInventory(id); // Simple Editor (Stock/Price)
        }
    },
    editInventory: (id) => { app.data.editingId = id; const p = app.data.products.find(x => x.id === id); document.getElementById('edit-inv-name').innerText = p.name; document.getElementById('edit-inv-stock').value = p.stock; document.getElementById('edit-inv-price').value = p.price; document.getElementById('modal-edit-inventory').classList.add('open'); },
    saveInventory: () => { const p = app.data.products.find(x => x.id === app.data.editingId); p.stock = parseInt(document.getElementById('edit-inv-stock').value); p.price = parseFloat(document.getElementById('edit-inv-price').value); app.saveData(); app.closeModal('modal-edit-inventory'); app.renderInventory(); },
    updateClock: () => { const now = new Date(); document.getElementById('big-clock').innerText = now.toLocaleTimeString(); document.getElementById('big-date').innerText = now.toLocaleDateString(undefined, {weekday:'long', month:'long', day:'numeric'}); document.getElementById('live-clock').innerText = now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}); },
    renderTimeClock: () => { document.getElementById('time-employee-select').innerHTML = '<option value="">Select your name...</option>' + app.data.employees.map(e => `<option value="${e.id}">${e.name}</option>`).join(''); const active = app.data.timeEntries.filter(e => !e.out); document.getElementById('active-workers-list').innerHTML = active.map(e => { const emp = app.data.employees.find(x=>x.id==e.empId); return `<div class="worker-pill"><i class="fa-solid fa-user-clock"></i> ${emp?emp.name:'?'}</div>` }).join(''); document.getElementById('time-active-count').innerText = active.length; let weekHrs = 0; const startOfWeek = new Date(); startOfWeek.setDate(startOfWeek.getDate() - startOfWeek.getDay()); app.data.timeEntries.forEach(e => { if(e.out && new Date(e.in) >= startOfWeek) weekHrs += (new Date(e.out) - new Date(e.in)) / 36e5; }); document.getElementById('time-hours-week').innerText = weekHrs.toFixed(1); document.getElementById('time-entries-body').innerHTML = [...app.data.timeEntries].reverse().slice(0, 5).map(e => { const emp = app.data.employees.find(x=>x.id==e.empId); return `<tr><td>${emp?emp.name:'?'}</td><td>${new Date(e.in).toLocaleTimeString()}</td><td>${e.out?new Date(e.out).toLocaleTimeString():'-'}</td><td>${e.out?((new Date(e.out)-new Date(e.in))/36e5).toFixed(2):'Running'}</td></tr>` }).join(''); },
    clockIn: () => { const eid = document.getElementById('time-employee-select').value; if(!eid) return alert("Select name"); if(app.data.timeEntries.find(e => e.empId == eid && !e.out)) return alert("Already clocked in"); app.data.timeEntries.push({id: Date.now(), empId: eid, in: new Date().toISOString(), out: null}); app.saveData(); app.renderTimeClock(); },
    clockOut: () => { const eid = document.getElementById('time-employee-select').value; if(!eid) return alert("Select name"); const entry = app.data.timeEntries.find(e => e.empId == eid && !e.out); if(!entry) return alert("Not clocked in"); entry.out = new Date().toISOString(); app.saveData(); app.renderTimeClock(); },
    renderProductsManager: () => { document.getElementById('products-manager-body').innerHTML = app.data.products.map(p => `<tr><td><img src="${p.img}" style="width:40px;height:40px;object-fit:cover;border-radius:4px;" onerror="this.src='https://via.placeholder.com/40'"></td><td>${p.name}</td><td>$${p.price.toFixed(2)}</td><td><button class="btn-sm" onclick="app.editProduct(${p.id})">Edit</button> <button class="btn-sm btn-danger-sm" onclick="app.deleteProduct(${p.id})">X</button></td></tr>`).join(''); },
    openProductModal: (isEdit = false) => { document.getElementById('prod-modal-title').innerText = isEdit ? "Edit Product" : "Add Product"; document.getElementById('prod-options-list').innerHTML = ''; if(!isEdit) { app.data.editingId = null; document.getElementById('prod-name').value = ""; document.getElementById('prod-price').value = ""; document.getElementById('prod-stock').value = ""; document.getElementById('prod-img-url').value = ""; app.data.tempOptionsList = []; } app.renderProductOptionsUI(); document.getElementById('modal-product').classList.add('open'); },
    editProduct: (id) => { const p = app.data.products.find(x => x.id === id); app.data.editingId = id; document.getElementById('prod-name').value = p.name; document.getElementById('prod-cat').value = p.cat; document.getElementById('prod-price').value = p.price; document.getElementById('prod-stock').value = p.stock; document.getElementById('prod-img-url').value = p.img; app.data.tempOptionsList = p.options ? JSON.parse(JSON.stringify(p.options)) : []; app.openProductModal(true); },
    renderProductOptionsUI: () => { const c = document.getElementById('prod-options-list'); c.innerHTML = ''; if(!app.data.tempOptionsList.length) { c.innerHTML='<p style="color:#777">No options.</p>'; return; } app.data.tempOptionsList.forEach((g,i) => { c.innerHTML += `<div><b>${g.name} (${g.type})</b> <button class="btn-sm btn-danger-sm" onclick="app.removeProductOptionGroup(${i})">x</button></div>`; }); },
    addProductOptionUI: () => { const n = prompt("Name:"); if(!n) return; const t = prompt("Type (select/radio/toggle):"); if(['select','radio','toggle'].includes(t)) { app.data.tempOptionsList.push({name:n, type:t, choices:[]}); app.renderProductOptionsUI(); } },
    removeProductOptionGroup: (i) => { app.data.tempOptionsList.splice(i,1); app.renderProductOptionsUI(); },
    saveProduct: () => { /* Save logic */ app.saveData(); app.closeModal('modal-product'); app.renderProductsManager(); if(document.querySelector('#view-inventory').classList.contains('active')) app.renderInventory(); },
    deleteProduct: (id) => { if(confirm("Delete?")) { app.data.products = app.data.products.filter(p => p.id !== id); app.saveData(); app.renderProductsManager(); if(document.querySelector('#view-inventory').classList.contains('active')) app.renderInventory(); } },
    renderEmployeesManager: () => { document.getElementById('employees-body').innerHTML = app.data.employees.map(e => `<tr><td><img src="${e.img}" class="emp-thumb"></td><td>${e.name}</td><td>${e.role}</td><td><button class="btn-sm" onclick="app.editEmployee(${e.id})">Edit</button> <button class="btn-sm btn-danger-sm" onclick="app.deleteEmployee(${e.id})">X</button></td></tr>`).join(''); },
    openEmployeeModal: (isEdit = false) => { document.getElementById('emp-modal-title').innerText = isEdit ? "Edit Employee" : "Add Employee"; if(!isEdit) { app.data.editingId = null; document.getElementById('emp-name').value = ""; document.getElementById('emp-img-url').value = ""; } document.getElementById('modal-employee').classList.add('open'); },
    editEmployee: (id) => { const e = app.data.employees.find(x => x.id === id); app.data.editingId = id; document.getElementById('emp-name').value = e.name; document.getElementById('emp-role').value = e.role; document.getElementById('emp-img-url').value = e.img; app.openEmployeeModal(true); },
    saveEmployee: () => { const n = document.getElementById('emp-name').value; if(!n) return; const r = document.getElementById('emp-role').value; const i = document.getElementById('emp-img-url').value || 'images/placeholder.png'; if(app.data.editingId) { const e = app.data.employees.find(x => x.id === app.data.editingId); e.name=n; e.role=r; e.img=i; } else { app.data.employees.push({id:Date.now(), name:n, role:r, img:i}); } app.saveData(); app.closeModal('modal-employee'); app.renderEmployeesManager(); app.renderLogin(); },
    deleteEmployee: (id) => { 
        if(confirm("Remove?")) { 
            app.requestPin((pin) => {
                if(pin==="1234") { 
                    app.data.employees=app.data.employees.filter(e=>e.id!==id); 
                    app.saveData(); app.renderEmployeesManager(); app.renderLogin(); 
                } else alert("Incorrect PIN");
            });
        } 
    },
    
    closeModal: (id) => document.getElementById(id).classList.remove('open')
};
app.init();
</script>
</body>
</html>